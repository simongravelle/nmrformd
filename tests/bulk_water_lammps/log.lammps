LAMMPS (22 Dec 2022)
# LAMMPS input file
# Bulk TIP4P/2005 water system
# author : Simon Gravelle

# variables
variable pre equal 1 # desired pressure (Atm)
variable tem equal 293.15 # desired temperature (K)

# main parameters
units real # style of units (A, fs, Kcal/mol)
atom_style full # molecular + charge
bond_style harmonic
angle_style harmonic
boundary p p p # periodic boundary conditions
pair_style lj/cut/tip4p/long 1 2 1 1 0.105 10 # cut-off 1 nm
kspace_style pppm/tip4p 1.0e-5
pair_modify mix arithmetic tail yes # eij = sqrt(ei*ej), dij = 0.5*(di+dj)

# import positions and parameters
read_data conf.data
Reading data file ...
  orthogonal box = (-10.370135 -10.370135 -10.370135) to (10.370135 10.370135 10.370135)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  900 atoms
  reading velocities ...
  900 velocities
  scanning bonds ...
  2 = max bonds/atom
  scanning angles ...
  1 = max angles/atom
  reading bonds ...
  600 bonds
  reading angles ...
  300 angles
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     2 = max # of 1-2 neighbors
     1 = max # of 1-3 neighbors
     1 = max # of 1-4 neighbors
     2 = max # of special neighbors
  special bonds CPU = 0.011 seconds
  read_data CPU = 0.068 seconds
include PARM.lammps
# TIP4P/2005 rigid water model parameters

# mass parameters
mass 1 15.9994 # O water TIP4P/2005
mass 2 1.008 # H water TIP4P/2005

# pair coeffs
pair_coeff 1 1 0.18481 3.165 # TIP4P/2005
pair_coeff 2 2 0.0 0.0 # TIP4P/2005

# bond coeffs
bond_coeff 1 0 0.9572 # TIP4P/2005

# angle coeffs
angle_coeff 1 0 104.52 # TIP4P/2005

# groups
group wat type 1 2 # water
900 atoms in group wat
group hyd type 2 # hydrogen
600 atoms in group hyd

# dynamics
timestep 2 # (fs)
fix myshk wat shake 1.0e-5 200 0 b 1 a 1 # shake with increased precision
Finding SHAKE clusters ...
       0 = # of size 2 clusters
       0 = # of size 3 clusters
       0 = # of size 4 clusters
     300 = # of frozen angles
  find clusters CPU = 0.000 seconds
fix mynpt all npt temp ${tem} ${tem} 100 iso ${pre} ${pre} 1000 # npt equilibrium
fix mynpt all npt temp 293.15 ${tem} 100 iso ${pre} ${pre} 1000 
fix mynpt all npt temp 293.15 293.15 100 iso ${pre} ${pre} 1000 
fix mynpt all npt temp 293.15 293.15 100 iso 1 ${pre} 1000 
fix mynpt all npt temp 293.15 293.15 100 iso 1 1 1000 

# output
dump dp1 wat xtc 500 traj.xtc # print atom positions every 1 timestep
thermo 1000

# run
run 100000 # 200 ps
PPPM initialization ...
  extracting TIP4P info from pair style
  using 12-bit tables for long-range coulomb (../kspace.cpp:342)
  G vector (1/distance) = 0.31250113
  grid = 20 20 20
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0030044428
  estimated relative force accuracy = 9.0477902e-06
  using double precision KISS FFT
  3d grid and FFT values/proc = 4913 1200
WARNING: Communication cutoff 0 is shorter than a bond length based estimate of 3.4358. This may lead to errors. (../comm.cpp:723)
WARNING: Increasing communication cutoff to 13.0622 for TIP4P pair style (../pair_lj_cut_tip4p_long.cpp:484)
Generated 1 of 1 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12.21
  ghost atom cutoff = 13.0622
  binsize = 6.105, bins = 4 4 4
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut/tip4p/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 8.594 | 8.604 | 8.614 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press          Volume    
         0   293.25385     -3553.3905      0             -3029.7842     -1294.3343      8921.6098    
      1000   295.03379     -3559.3798      0             -3032.5955     -742.31827      8845.3502    
      2000   291.7929      -3589.2575      0             -3068.2597      1028.2118      9030.7118    
      3000   303.8235      -3589.1665      0             -3046.6881      1242.3778      8785.6596    
      4000   292.45588     -3577.82        0             -3055.6385      346.54537      8871.2138    
      5000   301.23895     -3595.9569      0             -3058.0932     -338.71246      9142.1827    
      6000   298.77767     -3556.9251      0             -3023.456      -364.33548      9183.8332    
      7000   305.79107     -3564.2164      0             -3018.2249     -725.55389      9186.169     
      8000   292.46055     -3617.2238      0             -3095.0339      670.99029      9058.7228    
      9000   296.42428     -3601.7918      0             -3072.5247      336.23811      9011.9084    
     10000   318.79573     -3590.1957      0             -3020.9843      1281.3068      8990.6026    
     11000   299.17635     -3553.9362      0             -3019.7553     -509.4227       9078.3474    
     12000   292.51974     -3558.0105      0             -3035.715      -422.5007       9157.1772    
     13000   292.15555     -3607.925       0             -3086.2797     -426.05532      9076.0577    
     14000   291.90142     -3532.4814      0             -3011.2899      1657.0508      9103.7935    
     15000   276.25867     -3610.9602      0             -3117.6989      1127.2258      8910.0829    
     16000   301.37937     -3598.0994      0             -3059.9849      269.04902      9128.1196    
     17000   284.75681     -3546.6348      0             -3038.2         776.17649      8988.3409    
     18000   303.89542     -3632.5486      0             -3089.9417      330.62947      9234.2629    
     19000   286.87399     -3607.5849      0             -3095.3699      1367.0086      8943.7279    
     20000   299.23089     -3615.9137      0             -3081.6354     -228.51596      9196.7769    
     21000   287.60717     -3571.9721      0             -3058.448       1933.4653      8962.4575    
     22000   302.78841     -3557.2315      0             -3016.6013     -832.37234      9078.1854    
     23000   297.63812     -3574.0824      0             -3042.648      -823.64047      8992.3901    
     24000   294.61588     -3549.2136      0             -3023.1754      706.70773      8764.9589    
     25000   285.04735     -3594.5231      0             -3085.5696      30.365661      8922.7132    
     26000   287.48427     -3596.4585      0             -3083.1538     -340.23557      8953.7589    
     27000   284.99999     -3566.1768      0             -3057.3078      316.38923      8950.1478    
     28000   282.52922     -3603.552       0             -3099.0946      308.82105      9052.8329    
     29000   281.63383     -3599.2949      0             -3096.4362     -470.08219      9055.2584    
     30000   287.76751     -3616.9138      0             -3103.1034     -907.3454       9144.7699    
     31000   287.89964     -3582.061       0             -3068.0147      1178.9327      9212.8603    
     32000   276.60807     -3602.3389      0             -3108.4538     -690.09989      9058.7203    
     33000   290.85594     -3533.9807      0             -3014.6559     -1861.6472      9051.6158    
     34000   293.57132     -3548.5356      0             -3024.3625     -146.50215      9101.5971    
     35000   301.89019     -3584.8535      0             -3045.827       1133.5935      8872.2869    
     36000   298.92673     -3561.4008      0             -3027.6656     -696.63383      9173.0298    
     37000   290.11027     -3615.3843      0             -3097.3909      1130.9942      8866.1311    
     38000   280.61806     -3600.9412      0             -3099.8962     -1122.6522      9130.4196    
     39000   303.12457     -3603.8366      0             -3062.6061      629.92653      9090.0757    
     40000   298.22569     -3632.1111      0             -3099.6276      719.84614      9111.0243    
     41000   312.82182     -3554.3751      0             -2995.8301     -463.62952      8978.0742    
     42000   285.45099     -3610.0641      0             -3100.3898     -504.0894       9075.1368    
     43000   302.95644     -3574.1863      0             -3033.256       399.17491      9044.7175    
     44000   286.76847     -3518.4975      0             -3006.4709     -912.00967      8875.1332    
     45000   320.11265     -3578.1138      0             -3006.551      -379.06455      9132.9193    
     46000   307.2053      -3603.5422      0             -3055.0255      816.4551       8951.0287    
     47000   304.12716     -3616.4955      0             -3073.4749      525.00755      9019.6391    
     48000   289.37902     -3562.153       0             -3045.4653     -965.46474      9011.817     
     49000   295.6698      -3606.7168      0             -3078.7968     -1015.8842      9096.7631    
     50000   296.49623     -3570.4421      0             -3041.0465     -467.26956      8937.319     
     51000   293.49548     -3596.8238      0             -3072.786      -140.43828      9132.6797    
     52000   281.29956     -3572.6598      0             -3070.398      -206.20619      8931.8122    
     53000   294.66792     -3603.0658      0             -3076.9347      77.524173      9047.4468    
     54000   279.56058     -3563.0111      0             -3063.8542     -416.74875      8889.8303    
     55000   313.93429     -3567.0668      0             -3006.5355      626.55582      9022.122     
     56000   279.14085     -3589.1476      0             -3090.7401      353.62844      8945.4406    
     57000   298.37807     -3640.6181      0             -3107.8625      224.24644      8962.297     
     58000   277.46005     -3598.0516      0             -3102.6452     -445.1888       9093.3197    
     59000   294.70407     -3608.4728      0             -3082.2771     -497.73563      8975.0097    
     60000   309.38654     -3568.6923      0             -3016.281      -352.75322      9107.8903    
     61000   295.2713      -3588.8502      0             -3061.6418      530.80835      8781.9902    
     62000   286.21924     -3625.189       0             -3114.143       540.3966       8892.4614    
     63000   281.37294     -3609.994       0             -3107.6011      402.67366      8884.4775    
     64000   316.37114     -3602.3947      0             -3037.5124     -72.662243      8867.5167    
     65000   283.09814     -3575.5091      0             -3070.0359      297.91399      8731.5204    
     66000   299.0109      -3555.7758      0             -3021.8902      913.13188      8974.7758    
     67000   297.07293     -3603.9863      0             -3073.561       122.63624      9050.0228    
     68000   282.11408     -3593.0792      0             -3089.3631     -665.06589      9093.9229    
     69000   288.54743     -3591.0068      0             -3075.8038     -1102.7965      9042.7523    
     70000   280.6475      -3629.2737      0             -3128.1762     -850.14209      9012.4005    
     71000   293.21826     -3565.2743      0             -3041.7316     -981.06672      9254.1724    
     72000   286.54294     -3604.6195      0             -3092.9956     -344.1476       9193.5155    
     73000   281.53715     -3592.639       0             -3089.953       571.59516      8893.3657    
     74000   283.10845     -3561.7533      0             -3056.2617     -193.48408      9085.1469    
     75000   277.26261     -3532.9063      0             -3037.8525     -483.68516      8979.8264    
     76000   276.33194     -3570.2915      0             -3076.8994     -61.426467      8980.0785    
     77000   294.89362     -3535.0278      0             -3008.4937      267.26478      9045.1629    
     78000   296.39648     -3639.8449      0             -3110.6274      621.27233      9052.0216    
     79000   292.52442     -3601.8484      0             -3079.5446     -75.928371      9078.9499    
     80000   296.80512     -3572.6538      0             -3042.7068      536.5999       8988.7149    
     81000   305.51064     -3538.2563      0             -2992.7655      1177.0516      8863.0627    
     82000   270.37704     -3609.1117      0             -3126.3521     -1080.8055      9040.6138    
     83000   305.72046     -3611.4983      0             -3065.6329      678.66914      8852.9484    
     84000   269.84535     -3600.7882      0             -3118.9779      654.24547      8831.568     
     85000   279.45904     -3573.9808      0             -3075.0052     -87.814448      9151.5376    
     86000   304.58638     -3607.8825      0             -3064.0419      388.25114      8961.7282    
     87000   292.26485     -3574.6778      0             -3052.8374     -636.10024      9301.8168    
     88000   305.66832     -3570.3445      0             -3024.5722     -630.12739      9043.4087    
     89000   290.56936     -3626.952       0             -3108.1389      84.852598      9058.1635    
     90000   283.46078     -3627.6139      0             -3121.4932      226.8863       9055.3133    
     91000   293.80024     -3588.1481      0             -3063.5663     -126.87261      8998.4459    
     92000   297.58221     -3560.7041      0             -3029.3695      317.50775      9025.4512    
     93000   303.26733     -3559.855       0             -3018.3696     -378.37829      9071.7885    
     94000   305.5572      -3588.8068      0             -3043.2328     -1114.2469      9320.9221    
     95000   285.59787     -3599.8823      0             -3089.9458      105.36434      9037.2926    
     96000   306.44481     -3619.409       0             -3072.2502     -151.50494      9145.684     
     97000   296.98988     -3587.8567      0             -3057.5797      43.829256      9231.0723    
     98000   281.59428     -3608.4991      0             -3105.7111      398.02745      8971.3383    
     99000   286.2924      -3577.1293      0             -3065.9527     -54.81747       9176.7914    
    100000   275.1978      -3625.9286      0             -3134.5615     -943.96402      8894.2185    
Loop time of 272.58 on 8 procs for 100000 steps with 900 atoms

Performance: 63.394 ns/day, 0.379 hours/ns, 366.865 timesteps/s, 330.178 katom-step/s
96.2% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 92.885     | 114.23     | 136.37     | 135.9 | 41.91
Bond    | 0.019857   | 0.026113   | 0.039788   |   3.8 |  0.01
Kspace  | 85.411     | 107.93     | 129.92     | 144.0 | 39.59
Neigh   | 11.464     | 11.575     | 11.679     |   2.4 |  4.25
Comm    | 11.65      | 12.391     | 13.165     |  15.4 |  4.55
Output  | 0.019991   | 0.021558   | 0.029395   |   2.0 |  0.01
Modify  | 16.431     | 19.583     | 22.544     |  47.1 |  7.18
Other   |            | 6.827      |            |       |  2.50

Nlocal:          112.5 ave         124 max         104 min
Histogram: 3 0 0 1 1 1 0 0 0 2
Nghost:        4792.88 ave        4847 max        4754 min
Histogram: 1 2 0 1 1 1 1 0 0 1
Neighs:        43468.9 ave       49639 max       37051 min
Histogram: 1 0 0 1 2 1 1 1 0 1

Total # of neighbors = 347751
Ave neighs/atom = 386.39
Ave special neighs/atom = 2
Neighbor list builds = 7426
Dangerous builds = 0
Total wall time: 0:04:32
